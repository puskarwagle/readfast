<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Capsicum Speed Reader</title>
<link rel="icon" type="image/x-icon" href="capsicum.ico">
<link rel="icon" type="image/png" href="capsicum.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<!-- SVG Filter for PDF recoloring -->
<svg style="visibility: hidden; height: 0; width: 0; position: absolute; pointer-events: none;">
  <defs>
    <filter id="pdf-recolor" color-interpolation-filters="sRGB">
      <feColorMatrix id="pdf-recolor-matrix" type="matrix" 
        values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0"/>
    </filter>
  </defs>
</svg>

<button id="hamburger-btn" class="hamburger-btn" aria-label="Toggle books menu">
  <span></span>
  <span></span>
  <span></span>
</button>

<button id="controls-hamburger-btn" class="controls-hamburger-btn" aria-label="Toggle controls menu">
  <span></span>
  <span></span>
  <span></span>
</button>

<div id="books" class="books-panel">
  <div class="sidebar-header">
    <img src="capsicum.png" alt="Capsicum Logo" class="sidebar-logo">
    <h2 class="sidebar-title">Your Books</h2>
  </div>
  <div id="loading-books" class="loading-text">Loading books...</div>
  <div id="books-grid" class="books-grid"></div>
</div>

<div id="viewer-wrapper">
  <div id="main-container">
    <div id="display-area" role="region" aria-label="Reading area"></div>
    <div id="cursor"></div>
    <div id="readfast-page-info"></div>
  </div>

  <div id="pdf-container" style="display: none;">
    <div id="pdf-viewer">
      <canvas id="pdf-canvas"></canvas>
      <div id="pdf-text-layer"></div>
    </div>
    <div id="pdf-page-info"></div>
  </div>
</div>

<div id="controls-panel">
  <div class="control-card tabs-container">
    <button id="tab-readfast" class="tab-button active" aria-label="Switch to ReadFast view">ReadFast</button>
    <button id="tab-real" class="tab-button" aria-label="Switch to Real PDF view">Real</button>
  </div>
  <div class="control-card">
    <button id="toggle-mode" aria-label="Toggle between smooth and word mode">Smooth</button>
  </div>

  <div class="nav-row readfast-nav-buttons">
    <div class="control-card nav-button">
      <button id="readfast-prev" aria-label="Previous page">◀</button>
    </div>
    <div class="control-card nav-button">
      <button id="play-pause" aria-label="Play or pause reading">⏸</button>
    </div>
    <div class="control-card nav-button">
      <button id="readfast-next" aria-label="Next page">▶</button>
    </div>
  </div>

  <div class="control-card slider-container">
    <div class="slider-header">
      <span class="slider-label">Speed</span>
      <span id="speed-value">250 wpm</span>
    </div>
    <input type="range" id="speed-slider" min="50" max="1000" step="10" value="250" aria-label="Reading speed">
  </div>

  <div class="nav-row pdf-nav-buttons" style="display: none;">
    <div class="control-card nav-button">
      <button id="prev-page" aria-label="Previous page">◀</button>
    </div>
    <div class="control-card nav-button">
      <button id="pdf-highlight-play" aria-label="Play or pause auto-highlighting">⏸</button>
    </div>
    <div class="control-card nav-button">
      <button id="next-page" aria-label="Next page">▶</button>
    </div>
  </div>

  <div class="nav-row pdf-nav-buttons" style="display: none;">
    <div class="control-card nav-button">
      <button id="zoom-out" aria-label="Zoom out">-</button>
    </div>
    <div class="control-card nav-button">
      <button id="zoom-in" aria-label="Zoom in">+</button>
    </div>
  </div>

  <div class="color-controls">
    <div class="color-control-row">
      <label for="text-color">Text Color:</label>
      <input type="color" id="text-color" value="#ffffff">
    </div>
    <div class="color-control-row">
      <label for="bg-color">Background:</label>
      <input type="color" id="bg-color" value="#000000">
    </div>
  </div>
</div>

<div class="loading-overlay" id="loading-overlay">
  <img src="capsicum.png" alt="Capsicum Logo" class="loading-logo">
  <div class="loading-spinner"></div>
  <p>Extracting text from PDF...</p>
</div>

<div id="measure"></div>
<div id="current-word" aria-live="polite" aria-atomic="true" style="position: absolute; left: -10000px;"></div>

<script src="app.js"></script>
</body>
</html>